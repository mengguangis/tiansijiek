<html>
<head>
<meta charset ="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1"> 
<title>Deferred Shader</title>
</head>

<body>
<canvas id="canvas" style="border: none;" width="1280" height="720" tabindex="1"></canvas>
<script type = "text/javascript" src="js/gl-matrix.js"></script>
<script type = "x-shader/x-vertex" id = "quadvs">
	attribute vec3 Position;
	attribute vec2 Texcoord;

	varying vec2 fs_Texcoord;
	void main(void){
		fs_Texcoord = Texcoord;
		gl_Position = vec4(Position,1.0);
	}
</script>
<script type="x-shader/x-fragment" id = "quadfs">
	precision mediump float;
	uniform int u_Displaymode;

	uniform sampler2D u_NormalSampler;
	uniform sampler2D u_ColorSampler;
	
	varying vec2 fs_Texcoord;

	void main(void)
	{
		if(u_Displaymode == 0){
			//display all
			gl_FragColor = texture2D(u_ColorSampler,fs_Texcoord);
		}
		else if(u_Displaymode == 1){
			//display normal
			gl_FragColor = texture2D(u_NormalSampler,fs_Texcoord);
		}
		else
		{
			gl_FragColor = vec4(1.0,0.0,0.0,1.0);
		}
	}

</script>
<script type="x-shader/x-vertex" id = "vs">
	uniform mat4 u_Model;
	uniform mat4 u_View;
	uniform mat4 u_Persp;
	uniform mat4 u_Inverse; 
	


	attribute vec3 Position;
	attribute vec2 Texcood;
	attribute vec3 Normal;

	varying vec2 vTexcoord;
	varying vec3 vNormal;
	void main(void) {
		gl_Position = u_Persp * u_View * u_Model * vec4(Position,1.0);
		vTexcoord = Texcood;
		vNormal = (u_Inverse * vec4(Normal,0.0)).xyz;		 
	}
</script>
<script type="x-shader/x-fragment" id = "fs">
	precision mediump float; // have to add this, dont' exactly know why

	uniform sampler2D u_NormalSampler;
	uniform sampler2D u_ColorSampler;
	
	uniform int u_Displaymode;


	varying vec2 vTexcoord;
	varying vec3 vNormal;
	void main(void) {
		if(u_Displaymode == 0)
		{
			//display color
			gl_FragColor = texture2D(u_ColorSampler,vTexcoord);			
			return;
		}
		else if(u_Displaymode == 1)
		{
			//diaplay normal
			gl_FragColor = vec4(abs(vNormal),1.0);
			return;			
		}
	}
</script>

<script src="js/webGLUtility.js"></script> 
<script type = "text/javascript" src="js/index.js"></script>

</body>

</html>
